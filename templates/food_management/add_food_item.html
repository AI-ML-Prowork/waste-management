{% extends 'base.html' %}
{% block title %}Add Food{% endblock %}

{% block content %}

    <h1>Add Food Item</h1>
    <form method="post">
        {% csrf_token %}
        {{ form.as_p }}
        <button type="submit">Submit</button>
    </form>

    
    <p>Didn't find your category? <a href="{% url 'add_category' %}">Click to Add</a></p>
    <p>Want to delete your category? <a href="{% url 'category_list' %}">Click to Delete</a></p>

    {% if barcode_image %}
        <!-- Display the barcode image using base64 data -->
        <img id="barcodeImage" src="data:image/png;base64,{{ barcode_image }}" alt="Barcode Image">
        <!-- Hidden details -->
        <div id="barcodeDetails" style="display: none;">
            {% for key, value in food_item_details.items %}
                <p>{{ key }}: {{ value }}</p>
            {% endfor %}
        </div>
        <!-- Download button -->
        <button id="downloadBarcodeBtn">Download Barcode</button>
    {% endif %}


    <script>
        // Function to trigger the download of the barcode image
        document.getElementById('downloadBarcodeBtn').addEventListener('click', function() {
            var barcodeImage = document.getElementById('barcodeImage');
            var link = document.createElement('a');
            link.href = barcodeImage.src;
            link.download = 'barcode.png';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        });
    </script>
    <style>
        #barcodeDetails {
            display: none;
        }
    </style>
{% endblock %}